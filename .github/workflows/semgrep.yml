name: Semgrep Security Scan

on:
  push:
    branches: [main, master]
  pull_request:
    branches: [main, master]
  schedule:
    # Scan hebdomadaire le lundi à 9h
    - cron: '0 9 * * 1'

jobs:
  semgrep:
    name: Scan de Sécurité
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v6

      - name: Run Semgrep
        run: |
          pip install semgrep
          semgrep --config=p/security-audit --config=p/secrets --config=p/owasp-top-ten --config=p/mobile \
            --error --no-rewrite-rule-ids .
